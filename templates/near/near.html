<!--test-->
<ons-page ng-controller="near" class="near_page">
    <ons-toolbar>
        <!--
        <div class="left">
            <ons-back-button>Back</ons-back-button>
        </div>
-->
        <div class="center">附近店家</div>
        <div class="right">
            <ons-toolbar-button ng-click="gotoSetting()">
                <ons-icon icon="ion-gear-a" style="vertical-align: -4px; font-size: 28px;"></ons-icon>
            </ons-toolbar-button>
        </div>
    </ons-toolbar>

    <div class="card">
        <div class="card-image">
            <div class="near_buttons">
                <button class="btn waves-effect waves-light" ng-disabled="!nowShop" ng-click="lookMenu()">瞧菜單</button>
                <button class="btn waves-effect waves-light" ng-disabled="!nowShop" ng-click="gotoStore()">看評論</button>
                <button class="btn waves-effect waves-light" ng-disabled="!nowShop" ng-click="callShop()">打電話</button>
            </div>
            <div id="googlemap" class="near_map"></div>
        </div>
        <div class="card-footer" ng-click="toggleCard()" swiper-Card open="card_open">
            <div class="card-avatar waves-effect waves-block">
                <div class="avatar" rn-lazy-background="shopAvatar(nowShop.company_id)"></div>
                <span class="title" ng-bind="nowShop.name || '選擇附近的飲料店'"></span>
                <p ng-bind="nowShop.address"></p>
                <i class="ion-ios-arrow-up"></i>
            </div>
        </div>
        <div class="card-reveal" ng-class="{'active':card_open}">
            <ons-scroller>
                <ons-list>
                    <div class="card-header" ng-click="toggleCard()">
                        <div class="card-avatar waves-effect waves-block">
                            <div class="avatar" rn-lazy-background="shopAvatar(nowShop.company_id)"></div>
                            <span class="title" ng-bind="nowShop.name|| '選擇附近的飲料店'"></span>
                            <p ng-bind="nowShop.address"></p>
                            <i class="ion-ios-close-empty"></i>
                        </div>
                    </div>
                    <ons-list-item modifier="chevron" class="list-item-container waves-effect waves-block" ng-repeat="shop in shopList" ng-click="clickShop(shop); toggleCard()" ng-class="{'near_item_active':nowShop_id === shop.id}">

                        <div class="avatar" back-img="{{shopAvatar(shop.company_id)}}" local="true"></div>

                        <div class="name">{{shop.company_name + shop.name}}
                            <span class="location">{{distance(shop)}}</span>
                        </div>
                        <div class="desc">{{shop.address}}</div>


                    </ons-list-item>
                </ons-list>
            </ons-scroller>
        </div>
    </div>
</ons-page>
